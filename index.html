<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>ianlrsn links</title>
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <main class="page">
      <section class="card">
        <header class="hero">
          <div class="avatar">ian</div>
          <p class="handle">@ianlrsn</p>
          <div class="socials" aria-label="social links">
            <a class="social" href="https://www.twitch.tv/ianlrsn" aria-label="Twitch">
              <img src="icons/twitch.svg" alt="" aria-hidden="true" />
            </a>
            <a class="social" href="https://tiktok.com/@ianlrsn" aria-label="TikTok">
              <img src="icons/tiktok.svg" alt="" aria-hidden="true" />
            </a>
            <a class="social" href="https://discord.gg/kdjjzfKE" aria-label="Discord">
              <img src="icons/discord.svg" alt="" aria-hidden="true" />
            </a>
            <a class="social" href="https://www.instagram.com/ianlrsn" aria-label="Instagram">
              <img src="icons/instagram.svg" alt="" aria-hidden="true" />
            </a>
            <a class="social" href="https://youtube.com/@ianlrsn?si=PY8eBxGL5ZDL8J9h" aria-label="YouTube">
              <img src="icons/youtube.svg" alt="" aria-hidden="true" />
            </a>
            <!-- Cash App icon removed; restore when donations link is ready. -->
          </div>
        </header>
        <section class="links">
          <a class="link" href="https://www.twitch.tv/ianlrsn" data-twitch>
            <span class="thumb">
              <img src="icons/twitch.svg" alt="" aria-hidden="true" />
            </span>
            <span class="label">Twitch @ianlrsn</span>
            <span class="status">
              <span class="live-dot" aria-hidden="true"></span>
              <span class="dots">&#8942;</span>
            </span>
          </a>
          <a class="link" href="https://youtube.com/@ianlrsn?si=PY8eBxGL5ZDL8J9h">
            <span class="thumb">
              <img src="icons/youtube.svg" alt="" aria-hidden="true" />
            </span>
            <span class="label">YouTube @ianlrsn</span>
            <span class="dots">&#8942;</span>
          </a>
          <a class="link" href="https://discord.gg/kdjjzfKE">
            <span class="thumb">
              <img src="icons/discord.svg" alt="" aria-hidden="true" />
            </span>
            <span class="label">Discord @ianlrsn</span>
            <span class="dots">&#8942;</span>
          </a>
          <a class="link" href="https://tiktok.com/@ianlrsn">
            <span class="thumb">
              <img src="icons/tiktok.svg" alt="" aria-hidden="true" />
            </span>
            <span class="label">TikTok @ianlrsn</span>
            <span class="dots">&#8942;</span>
          </a>
          <a class="link" href="https://www.instagram.com/ianlrsn">
            <span class="thumb">
              <img src="icons/instagram.svg" alt="" aria-hidden="true" />
            </span>
            <span class="label">Instagram @ianlrsn</span>
            <span class="dots">&#8942;</span>
          </a>
          <a class="link" href="#">
            <span class="thumb nintendo">
              <img src="icons/nintendo.svg" alt="" aria-hidden="true" />
            </span>
            <span class="label">Nintendo Â· SW-6525-1278-1508</span>
            <span class="dots">&#8942;</span>
          </a>
          <!-- Cash App tile removed; restore when donations link is ready. -->
        </section>
      </section>
    </main>
    <script>
      const twitchRow = document.querySelector("[data-twitch]");
      const liveDot = twitchRow?.querySelector(".live-dot");

      const checkTwitchLive = async () => {
        if (!twitchRow || !liveDot) return;
        try {
          const response = await fetch("/api/twitch-live", { cache: "no-store" });
          if (!response.ok) throw new Error("status fetch failed");
          const data = await response.json();
          const isLive = Boolean(data?.live);
          twitchRow.classList.toggle("is-live", isLive);
          liveDot.classList.toggle("show", isLive);
        } catch (error) {
          twitchRow.classList.remove("is-live");
          liveDot.classList.remove("show");
        }
      };

      checkTwitchLive();
      setInterval(checkTwitchLive, 60000);
    </script>
  </body>
</html>
